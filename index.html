<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Node JS PDF Gen Test</title>
</head>
<body>
    <h1>Node PDF Gen Test</h1>    
    <button onclick="handlePDF();">Gen PDF</button>
</body>
<script>
function handlePDF() {
    var req = new XMLHttpRequest();
    var url = 'http://localhost:3000/export/pdf';
    body = {
        title: 'My Fancy Title',
        date: '10/11/1987',
        name: 'Jamie Bullock',
        logo: 'https://via.placeholder.com/200x150',
    }
    body = JSON.stringify(body);
    console.log(body);
    req.open("GET", url, true);
    req.responseType = 'blob';
    // req.setRequestHeader('Access-Control-Allow-Origin', '*');
    req.setRequestHeader('Content-Type', 'application/json');
    req.onload = function (e) {
        if (req.readyState === 4) {
            if (req.status === 200) {
                console.log(req.response);
                // var disposition = req.getResponseHeader('content-disposition');
                // var matches = /"([^"]*)"/.exec(disposition);
                // var filename = (matches != null && matches[1] ? matches[1] : 'invoice.pdf');

                // The actual download
                var blob = new Blob([req.response], { type: 'application/pdf' });
                var link = document.createElement('a');
                link.href = window.URL.createObjectURL(blob);
                link.download = 'invoice.pdf';

                document.body.appendChild(link);

                link.click();

                document.body.removeChild(link);
            } else {
                console.error(req.statusText);
            }
        }
    };
    req.onerror = function (e) {
        console.error(req.statusText);
    }
    req.send(body);
}
</script>
</html>